var jt=Object.defineProperty;var Vt=(r,e,t)=>e in r?jt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var g=(r,e,t)=>Vt(r,typeof e!="symbol"?e+"":e,t);import{a as ut}from"./index-D9dwDVFR.js";var ge={exports:{}},k=typeof Reflect=="object"?Reflect:null,Ce=k&&typeof k.apply=="function"?k.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},ie;k&&typeof k.ownKeys=="function"?ie=k.ownKeys:Object.getOwnPropertySymbols?ie=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ie=function(e){return Object.getOwnPropertyNames(e)};function Bt(r){console&&console.warn&&console.warn(r)}var ft=Number.isNaN||function(e){return e!==e};function T(){T.init.call(this)}ge.exports=T;ge.exports.once=zt;T.EventEmitter=T;T.prototype._events=void 0;T.prototype._eventsCount=0;T.prototype._maxListeners=void 0;var Pe=10;function oe(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(T,"defaultMaxListeners",{enumerable:!0,get:function(){return Pe},set:function(r){if(typeof r!="number"||r<0||ft(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Pe=r}});T.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};T.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||ft(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function ht(r){return r._maxListeners===void 0?T.defaultMaxListeners:r._maxListeners}T.prototype.getMaxListeners=function(){return ht(this)};T.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var s=e==="error",o=this._events;if(o!==void 0)s=s&&o.error===void 0;else if(!s)return!1;if(s){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var l=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw l.context=i,l}var c=o[e];if(c===void 0)return!1;if(typeof c=="function")Ce(c,this,t);else for(var p=c.length,a=vt(c,p),n=0;n<p;++n)Ce(a[n],this,t);return!0};function Et(r,e,t,n){var s,o,i;if(oe(t),o=r._events,o===void 0?(o=r._events=Object.create(null),r._eventsCount=0):(o.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),o=r._events),i=o[e]),i===void 0)i=o[e]=t,++r._eventsCount;else if(typeof i=="function"?i=o[e]=n?[t,i]:[i,t]:n?i.unshift(t):i.push(t),s=ht(r),s>0&&i.length>s&&!i.warned){i.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=r,l.type=e,l.count=i.length,Bt(l)}return r}T.prototype.addListener=function(e,t){return Et(this,e,t,!1)};T.prototype.on=T.prototype.addListener;T.prototype.prependListener=function(e,t){return Et(this,e,t,!0)};function kt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function dt(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},s=kt.bind(n);return s.listener=t,n.wrapFn=s,s}T.prototype.once=function(e,t){return oe(t),this.on(e,dt(this,e,t)),this};T.prototype.prependOnceListener=function(e,t){return oe(t),this.prependListener(e,dt(this,e,t)),this};T.prototype.removeListener=function(e,t){var n,s,o,i,l;if(oe(t),s=this._events,s===void 0)return this;if(n=s[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){l=n[i].listener,o=i;break}if(o<0)return this;o===0?n.shift():Xt(n,o),n.length===1&&(s[e]=n[0]),s.removeListener!==void 0&&this.emit("removeListener",e,l||t)}return this};T.prototype.off=T.prototype.removeListener;T.prototype.removeAllListeners=function(e){var t,n,s;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),i;for(s=0;s<o.length;++s)i=o[s],i!=="removeListener"&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this};function pt(r,e,t){var n=r._events;if(n===void 0)return[];var s=n[e];return s===void 0?[]:typeof s=="function"?t?[s.listener||s]:[s]:t?Ht(s):vt(s,s.length)}T.prototype.listeners=function(e){return pt(this,e,!0)};T.prototype.rawListeners=function(e){return pt(this,e,!1)};T.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):mt.call(r,e)};T.prototype.listenerCount=mt;function mt(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}T.prototype.eventNames=function(){return this._eventsCount>0?ie(this._events):[]};function vt(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function Xt(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Ht(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function zt(r,e){return new Promise(function(t,n){function s(i){r.removeListener(e,o),n(i)}function o(){typeof r.removeListener=="function"&&r.removeListener("error",s),t([].slice.call(arguments))}It(r,e,o,{once:!0}),e!=="error"&&qt(r,s,{once:!0})})}function qt(r,e,t){typeof r.on=="function"&&It(r,"error",e,t)}function It(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function s(o){n.once&&r.removeEventListener(e,s),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var Kt=ge.exports;const Yt=ut(Kt),Wt={},$t=(r,e)=>{Wt[r]=e},z=r=>{class e extends Error{constructor(s,o,i){super(s||r,i);g(this,"cause");if(Object.setPrototypeOf(this,e.prototype),this.name=r,o)for(const l in o)this[l]=o[l];if(i&&Zt(i)&&"cause"in i&&!this.cause){const l=i.cause;this.cause=l,"stack"in l&&(this.stack=this.stack+`
CAUSE: `+l.stack)}}}return e};function Zt(r){return typeof r=="object"}const Jt=z("DisconnectedDevice"),Qt=z("DisconnectedDeviceDuringOperation"),er=z("TransportOpenUserCancelled"),De=z("TransportInterfaceNotAvailable"),tr=z("TransportRaceCondition"),rr=z("TransportWebUSBGestureRequired");var be;(function(r){r.Unknown="Unknown",r.LocationServicesDisabled="LocationServicesDisabled",r.LocationServicesUnauthorized="LocationServicesUnauthorized",r.BluetoothScanStartFailed="BluetoothScanStartFailed"})(be||(be={}));class j extends Error{constructor(t,n){const s="TransportError";super(t||s);g(this,"id");this.name=s,this.message=t,this.stack=new Error(t).stack,this.id=n}}$t("TransportError",r=>new j(r.message,r.id));const X={ACCESS_CONDITION_NOT_FULFILLED:38916,ALGORITHM_NOT_SUPPORTED:38020,CLA_NOT_SUPPORTED:28160,CODE_BLOCKED:38976,CODE_NOT_INITIALIZED:38914,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,CONDITIONS_OF_USE_NOT_SATISFIED:27013,CONTRADICTION_INVALIDATION:38928,CONTRADICTION_SECRET_CODE_STATUS:38920,DEVICE_IN_RECOVERY_MODE:26159,CUSTOM_IMAGE_EMPTY:26158,FILE_ALREADY_EXISTS:27273,FILE_NOT_FOUND:37892,GP_AUTH_FAILED:25344,HALTED:28586,INCONSISTENT_FILE:37896,INCORRECT_DATA:27264,INCORRECT_LENGTH:26368,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,DEVICE_NOT_ONBOARDED:27911,DEVICE_NOT_ONBOARDED_2:26129,INVALID_KCV:38021,INVALID_OFFSET:37890,LICENSING:28482,LOCKED_DEVICE:21781,MAX_VALUE_REACHED:38992,MEMORY_PROBLEM:37440,MISSING_CRITICAL_PARAMETER:26624,NO_EF_SELECTED:37888,NOT_ENOUGH_MEMORY_SPACE:27268,OK:36864,PIN_REMAINING_ATTEMPTS:25536,REFERENCED_DATA_NOT_FOUND:27272,SECURITY_STATUS_NOT_SATISFIED:27010,TECHNICAL_PROBLEM:28416,UNKNOWN_APDU:27906,USER_REFUSED_ON_DEVICE:21761,NOT_ENOUGH_SPACE:20738,APP_NOT_FOUND_OR_INVALID_CONTEXT:20771,INVALID_APP_NAME_LENGTH:26378,GEN_AES_KEY_FAILED:21529,INTERNAL_CRYPTO_OPERATION_FAILED:21530,INTERNAL_COMPUTE_AES_CMAC_FAILED:21531,ENCRYPT_APP_STORAGE_FAILED:21532,INVALID_BACKUP_STATE:26178,PIN_NOT_SET:21762,INVALID_BACKUP_LENGTH:26419,INVALID_RESTORE_STATE:26179,INVALID_CHUNK_LENGTH:26420,INVALID_BACKUP_HEADER:26698,TRUSTCHAIN_WRONG_SEED:45063};function nr(r){switch(r){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received";case 21781:return"Locked device"}if(28416<=r&&r<=28671)return"Internal error, please report"}class H extends Error{constructor(t,{canBeMappedToChildError:n=!0}={}){const s=Object.keys(X).find(c=>X[c]===t)||"UNKNOWN_ERROR",o=nr(t)||s,i=t.toString(16),l=`Ledger device: ${o} (0x${i})`;super(l);g(this,"statusCode");g(this,"statusText");if(this.name="TransportStatusError",this.statusCode=t,this.statusText=s,Object.setPrototypeOf(this,H.prototype),n&&t===X.LOCKED_DEVICE)return new Ne(l)}}class Ne extends H{constructor(e){super(X.LOCKED_DEVICE,{canBeMappedToChildError:!1}),e&&(this.message=e),this.name="LockedDeviceError",Object.setPrototypeOf(this,Ne.prototype)}}$t("TransportStatusError",r=>new H(r.statusCode));let Lt=0;const M=[],Ue=(r,e,t)=>{const n={type:r,id:String(++Lt),date:new Date};e&&(n.message=e),Rt(n)},sr=({type:r,message:e,data:t,context:n})=>{const s={type:r,id:String(++Lt),date:new Date};e&&(s.message=e),t&&(s.data=t),n&&(s.context=n),Rt(s)};class Z{constructor(e,t){g(this,"type");g(this,"context");this.type=e,this.context=t}trace(e,t){sr({type:this.type,message:e,data:t,context:this.context})}getContext(){return this.context}setContext(e){this.context=e}updateContext(e){this.context={...this.context,...e}}getType(){return this.type}setType(e){this.type=e}withType(e){return new Z(e,this.context)}withContext(e){return new Z(this.type,e)}withUpdatedContext(e){return new Z(this.type,{...this.context,...e})}}const ir=r=>(M.push(r),()=>{const e=M.indexOf(r);e!==-1&&(M[e]=M[M.length-1],M.pop())});function Rt(r){for(let e=0;e<M.length;e++)try{M[e](r)}catch(t){console.error(t)}}typeof window<"u"&&(window.__ledgerLogsListen=ir);const or="transport";class B{constructor({context:e,logType:t}={}){g(this,"exchangeTimeout",3e4);g(this,"unresponsiveTimeout",15e3);g(this,"deviceModel",null);g(this,"tracer");g(this,"_events",new Yt);g(this,"send",async(e,t,n,s,o=Buffer.alloc(0),i=[X.OK],{abortTimeoutMs:l}={})=>{const c=this.tracer.withUpdatedContext({function:"send"});if(o.length>=256)throw c.trace("data.length exceeded 256 bytes limit",{dataLength:o.length}),new j("data.length exceed 256 bytes limit. Got: "+o.length,"DataLengthTooBig");const p=await this.exchange(Buffer.concat([Buffer.from([e,t,n,s]),Buffer.from([o.length]),o]),{abortTimeoutMs:l}),a=p.readUInt16BE(p.length-2);if(!i.some(h=>h===a))throw new H(a);return p});g(this,"exchangeBusyPromise");g(this,"_appAPIlock",null);this.tracer=new Z(t??or,e)}exchange(e,{abortTimeoutMs:t}={}){throw new Error("exchange not implemented")}exchangeBulk(e,t){let n=!1;const s=()=>{n=!0};return(async()=>{if(!n)for(const i of e){const l=await this.exchange(i);if(n)return;const c=l.readUInt16BE(l.length-2);if(c!==X.OK)throw new H(c);t.next(l)}})().then(()=>!n&&t.complete(),i=>!n&&t.error(i)),{unsubscribe:s}}setScrambleKey(e){}close(){return Promise.resolve()}on(e,t){this._events.on(e,t)}off(e,t){this._events.removeListener(e,t)}emit(e,...t){this._events.emit(e,...t)}setDebugMode(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")}setExchangeTimeout(e){this.exchangeTimeout=e}setExchangeUnresponsiveTimeout(e){this.unresponsiveTimeout=e}static create(e=3e3,t){return new Promise((n,s)=>{let o=!1;const i=this.listen({next:c=>{o=!0,i&&i.unsubscribe(),l&&clearTimeout(l),this.open(c.descriptor,e).then(n,s)},error:c=>{l&&clearTimeout(l),s(c)},complete:()=>{l&&clearTimeout(l),o||s(new j(this.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),l=t?setTimeout(()=>{i.unsubscribe(),s(new j(this.ErrorMessage_ListenTimeout,"ListenTimeout"))},t):null})}async exchangeAtomicImpl(e){const t=this.tracer.withUpdatedContext({function:"exchangeAtomicImpl",unresponsiveTimeout:this.unresponsiveTimeout});if(this.exchangeBusyPromise)throw t.trace("Atomic exchange is already busy"),new tr("An action was already pending on the Ledger device. Please deny or reconnect.");let n;const s=new Promise(l=>{n=l});this.exchangeBusyPromise=s;let o=!1;const i=setTimeout(()=>{t.trace('Timeout reached, emitting Transport event "unresponsive"',{unresponsiveTimeout:this.unresponsiveTimeout}),o=!0,this.emit("unresponsive")},this.unresponsiveTimeout);try{const l=await e();return o&&(t.trace("Device was unresponsive, emitting responsive"),this.emit("responsive")),l}finally{t.trace("Finalize, clearing busy guard"),clearTimeout(i),n&&n(),this.exchangeBusyPromise=null}}decorateAppAPIMethods(e,t,n){for(const s of t)e[s]=this.decorateAppAPIMethod(s,e[s],e,n)}decorateAppAPIMethod(e,t,n,s){return async(...o)=>{const{_appAPIlock:i}=this;if(i)return Promise.reject(new j("Ledger Device is busy (lock "+i+")","TransportLocked"));try{return this._appAPIlock=e,this.setScrambleKey(s),await t.apply(n,o)}finally{this._appAPIlock=null}}}setTraceContext(e){this.tracer=this.tracer.withContext(e)}updateTraceContext(e){this.tracer.updateContext(e)}getTraceContext(){return this.tracer.getContext()}}g(B,"isSupported"),g(B,"list"),g(B,"listen"),g(B,"open"),g(B,"ErrorMessage_ListenTimeout","No Ledger device found (timeout)"),g(B,"ErrorMessage_NoDeviceFound","No Ledger device found");const Fe=5;function ar(r){const e=Buffer.alloc(2);return e.writeUInt16BE(r,0),e}const cr={data:Buffer.alloc(0),dataLength:0,sequence:0},lr=(r,e)=>({makeBlocks(t){let n=Buffer.concat([ar(t.length),t]);const s=e-5,o=Math.ceil(n.length/s);n=Buffer.concat([n,Buffer.alloc(o*s-n.length+1).fill(0)]);const i=[];for(let l=0;l<o;l++){const c=Buffer.alloc(5);c.writeUInt16BE(r,0),c.writeUInt8(Fe,2),c.writeUInt16BE(l,3);const p=n.slice(l*s,(l+1)*s);i.push(Buffer.concat([c,p]))}return i},reduceResponse(t,n){let{data:s,dataLength:o,sequence:i}=t||cr;if(n.readUInt16BE(0)!==r)throw new j("Invalid channel","InvalidChannel");if(n.readUInt8(2)!==Fe)throw new j("Invalid tag","InvalidTag");if(n.readUInt16BE(3)!==i)throw new j("Invalid sequence","InvalidSequence");t||(o=n.readUInt16BE(5)),i++;const l=n.slice(t?5:7);return s=Buffer.concat([s,l]),s.length>o&&(s=s.slice(0,o)),{data:s,dataLength:o,sequence:i}},getReducedResult(t){if(t&&t.dataLength===t.data.length)return t.data}});var $e={exports:{}};const ur="2.0.0",gt=256,fr=Number.MAX_SAFE_INTEGER||9007199254740991,hr=16,Er=gt-6,dr=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var ae={MAX_LENGTH:gt,MAX_SAFE_COMPONENT_LENGTH:hr,MAX_SAFE_BUILD_LENGTH:Er,MAX_SAFE_INTEGER:fr,RELEASE_TYPES:dr,SEMVER_SPEC_VERSION:ur,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},he={};const pr=typeof process=="object"&&he&&he.NODE_DEBUG&&/\bsemver\b/i.test(he.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};var ce=pr;(function(r,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:s}=ae,o=ce;e=r.exports={};const i=e.re=[],l=e.safeRe=[],c=e.src=[],p=e.safeSrc=[],a=e.t={};let h=0;const N="[a-zA-Z0-9-]",m=[["\\s",1],["\\d",s],[N,n]],K=U=>{for(const[C,V]of m)U=U.split(`${C}*`).join(`${C}{0,${V}}`).split(`${C}+`).join(`${C}{1,${V}}`);return U},$=(U,C,V)=>{const _=K(C),F=h++;o(U,F,C),a[U]=F,c[F]=C,p[F]=_,i[F]=new RegExp(C,V?"g":void 0),l[F]=new RegExp(_,V?"g":void 0)};$("NUMERICIDENTIFIER","0|[1-9]\\d*"),$("NUMERICIDENTIFIERLOOSE","\\d+"),$("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${N}*`),$("MAINVERSION",`(${c[a.NUMERICIDENTIFIER]})\\.(${c[a.NUMERICIDENTIFIER]})\\.(${c[a.NUMERICIDENTIFIER]})`),$("MAINVERSIONLOOSE",`(${c[a.NUMERICIDENTIFIERLOOSE]})\\.(${c[a.NUMERICIDENTIFIERLOOSE]})\\.(${c[a.NUMERICIDENTIFIERLOOSE]})`),$("PRERELEASEIDENTIFIER",`(?:${c[a.NONNUMERICIDENTIFIER]}|${c[a.NUMERICIDENTIFIER]})`),$("PRERELEASEIDENTIFIERLOOSE",`(?:${c[a.NONNUMERICIDENTIFIER]}|${c[a.NUMERICIDENTIFIERLOOSE]})`),$("PRERELEASE",`(?:-(${c[a.PRERELEASEIDENTIFIER]}(?:\\.${c[a.PRERELEASEIDENTIFIER]})*))`),$("PRERELEASELOOSE",`(?:-?(${c[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[a.PRERELEASEIDENTIFIERLOOSE]})*))`),$("BUILDIDENTIFIER",`${N}+`),$("BUILD",`(?:\\+(${c[a.BUILDIDENTIFIER]}(?:\\.${c[a.BUILDIDENTIFIER]})*))`),$("FULLPLAIN",`v?${c[a.MAINVERSION]}${c[a.PRERELEASE]}?${c[a.BUILD]}?`),$("FULL",`^${c[a.FULLPLAIN]}$`),$("LOOSEPLAIN",`[v=\\s]*${c[a.MAINVERSIONLOOSE]}${c[a.PRERELEASELOOSE]}?${c[a.BUILD]}?`),$("LOOSE",`^${c[a.LOOSEPLAIN]}$`),$("GTLT","((?:<|>)?=?)"),$("XRANGEIDENTIFIERLOOSE",`${c[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),$("XRANGEIDENTIFIER",`${c[a.NUMERICIDENTIFIER]}|x|X|\\*`),$("XRANGEPLAIN",`[v=\\s]*(${c[a.XRANGEIDENTIFIER]})(?:\\.(${c[a.XRANGEIDENTIFIER]})(?:\\.(${c[a.XRANGEIDENTIFIER]})(?:${c[a.PRERELEASE]})?${c[a.BUILD]}?)?)?`),$("XRANGEPLAINLOOSE",`[v=\\s]*(${c[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[a.XRANGEIDENTIFIERLOOSE]})(?:${c[a.PRERELEASELOOSE]})?${c[a.BUILD]}?)?)?`),$("XRANGE",`^${c[a.GTLT]}\\s*${c[a.XRANGEPLAIN]}$`),$("XRANGELOOSE",`^${c[a.GTLT]}\\s*${c[a.XRANGEPLAINLOOSE]}$`),$("COERCEPLAIN",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?`),$("COERCE",`${c[a.COERCEPLAIN]}(?:$|[^\\d])`),$("COERCEFULL",c[a.COERCEPLAIN]+`(?:${c[a.PRERELEASE]})?(?:${c[a.BUILD]})?(?:$|[^\\d])`),$("COERCERTL",c[a.COERCE],!0),$("COERCERTLFULL",c[a.COERCEFULL],!0),$("LONETILDE","(?:~>?)"),$("TILDETRIM",`(\\s*)${c[a.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",$("TILDE",`^${c[a.LONETILDE]}${c[a.XRANGEPLAIN]}$`),$("TILDELOOSE",`^${c[a.LONETILDE]}${c[a.XRANGEPLAINLOOSE]}$`),$("LONECARET","(?:\\^)"),$("CARETTRIM",`(\\s*)${c[a.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",$("CARET",`^${c[a.LONECARET]}${c[a.XRANGEPLAIN]}$`),$("CARETLOOSE",`^${c[a.LONECARET]}${c[a.XRANGEPLAINLOOSE]}$`),$("COMPARATORLOOSE",`^${c[a.GTLT]}\\s*(${c[a.LOOSEPLAIN]})$|^$`),$("COMPARATOR",`^${c[a.GTLT]}\\s*(${c[a.FULLPLAIN]})$|^$`),$("COMPARATORTRIM",`(\\s*)${c[a.GTLT]}\\s*(${c[a.LOOSEPLAIN]}|${c[a.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",$("HYPHENRANGE",`^\\s*(${c[a.XRANGEPLAIN]})\\s+-\\s+(${c[a.XRANGEPLAIN]})\\s*$`),$("HYPHENRANGELOOSE",`^\\s*(${c[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[a.XRANGEPLAINLOOSE]})\\s*$`),$("STAR","(<|>)?=?\\s*\\*"),$("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),$("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})($e,$e.exports);var J=$e.exports;const mr=Object.freeze({loose:!0}),vr=Object.freeze({}),Ir=r=>r?typeof r!="object"?mr:r:vr;var Oe=Ir;const Me=/^[0-9]+$/,Nt=(r,e)=>{if(typeof r=="number"&&typeof e=="number")return r===e?0:r<e?-1:1;const t=Me.test(r),n=Me.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},$r=(r,e)=>Nt(e,r);var Ot={compareIdentifiers:Nt,rcompareIdentifiers:$r};const Q=ce,{MAX_LENGTH:Ge,MAX_SAFE_INTEGER:ee}=ae,{safeRe:te,t:re}=J,Lr=Oe,{compareIdentifiers:Ee}=Ot;let Rr=class b{constructor(e,t){if(t=Lr(t),e instanceof b){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Ge)throw new TypeError(`version is longer than ${Ge} characters`);Q("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?te[re.LOOSE]:te[re.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>ee||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ee||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ee||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){const o=+s;if(o>=0&&o<ee)return o}return s}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Q("SemVer.compare",this.version,this.options,e),!(e instanceof b)){if(typeof e=="string"&&e===this.version)return 0;e=new b(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof b||(e=new b(e,this.options)),this.major<e.major?-1:this.major>e.major?1:this.minor<e.minor?-1:this.minor>e.minor?1:this.patch<e.patch?-1:this.patch>e.patch?1:0}comparePre(e){if(e instanceof b||(e=new b(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],s=e.prerelease[t];if(Q("prerelease compare",t,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return Ee(n,s)}while(++t)}compareBuild(e){e instanceof b||(e=new b(e,this.options));let t=0;do{const n=this.build[t],s=e.build[t];if(Q("build compare",t,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return Ee(n,s)}while(++t)}inc(e,t,n){if(e.startsWith("pre")){if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(t){const s=`-${t}`.match(this.options.loose?te[re.PRERELEASELOOSE]:te[re.PRERELEASE]);if(!s||s[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const s=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[s];else{let o=this.prerelease.length;for(;--o>=0;)typeof this.prerelease[o]=="number"&&(this.prerelease[o]++,o=-2);if(o===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(s)}}if(t){let o=[t,s];n===!1&&(o=[t]),Ee(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=o):this.prerelease=o}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var x=Rr;const je=x,gr=(r,e,t=!1)=>{if(r instanceof je)return r;try{return new je(r,e)}catch(n){if(!t)return null;throw n}};var q=gr;const Nr=q,Or=(r,e)=>{const t=Nr(r,e);return t?t.version:null};var Tr=Or;const Sr=q,wr=(r,e)=>{const t=Sr(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null};var Ar=wr;const Ve=x,_r=(r,e,t,n,s)=>{typeof t=="string"&&(s=n,n=t,t=void 0);try{return new Ve(r instanceof Ve?r.version:r,t).inc(e,n,s).version}catch{return null}};var xr=_r;const Be=q,yr=(r,e)=>{const t=Be(r,null,!0),n=Be(e,null,!0),s=t.compare(n);if(s===0)return null;const o=s>0,i=o?t:n,l=o?n:t,c=!!i.prerelease.length;if(!!l.prerelease.length&&!c){if(!l.patch&&!l.minor)return"major";if(l.compareMain(i)===0)return l.minor&&!l.patch?"minor":"patch"}const a=c?"pre":"";return t.major!==n.major?a+"major":t.minor!==n.minor?a+"minor":t.patch!==n.patch?a+"patch":"prerelease"};var Cr=yr;const Pr=x,Dr=(r,e)=>new Pr(r,e).major;var br=Dr;const Ur=x,Fr=(r,e)=>new Ur(r,e).minor;var Mr=Fr;const Gr=x,jr=(r,e)=>new Gr(r,e).patch;var Vr=jr;const Br=q,kr=(r,e)=>{const t=Br(r,e);return t&&t.prerelease.length?t.prerelease:null};var Xr=kr;const ke=x,Hr=(r,e,t)=>new ke(r,t).compare(new ke(e,t));var P=Hr;const zr=P,qr=(r,e,t)=>zr(e,r,t);var Kr=qr;const Yr=P,Wr=(r,e)=>Yr(r,e,!0);var Zr=Wr;const Xe=x,Jr=(r,e,t)=>{const n=new Xe(r,t),s=new Xe(e,t);return n.compare(s)||n.compareBuild(s)};var Te=Jr;const Qr=Te,en=(r,e)=>r.sort((t,n)=>Qr(t,n,e));var tn=en;const rn=Te,nn=(r,e)=>r.sort((t,n)=>rn(n,t,e));var sn=nn;const on=P,an=(r,e,t)=>on(r,e,t)>0;var le=an;const cn=P,ln=(r,e,t)=>cn(r,e,t)<0;var Se=ln;const un=P,fn=(r,e,t)=>un(r,e,t)===0;var Tt=fn;const hn=P,En=(r,e,t)=>hn(r,e,t)!==0;var St=En;const dn=P,pn=(r,e,t)=>dn(r,e,t)>=0;var we=pn;const mn=P,vn=(r,e,t)=>mn(r,e,t)<=0;var Ae=vn;const In=Tt,$n=St,Ln=le,Rn=we,gn=Se,Nn=Ae,On=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return In(r,t,n);case"!=":return $n(r,t,n);case">":return Ln(r,t,n);case">=":return Rn(r,t,n);case"<":return gn(r,t,n);case"<=":return Nn(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};var wt=On;const Tn=x,Sn=q,{safeRe:ne,t:se}=J,wn=(r,e)=>{if(r instanceof Tn)return r;if(typeof r=="number"&&(r=String(r)),typeof r!="string")return null;e=e||{};let t=null;if(!e.rtl)t=r.match(e.includePrerelease?ne[se.COERCEFULL]:ne[se.COERCE]);else{const c=e.includePrerelease?ne[se.COERCERTLFULL]:ne[se.COERCERTL];let p;for(;(p=c.exec(r))&&(!t||t.index+t[0].length!==r.length);)(!t||p.index+p[0].length!==t.index+t[0].length)&&(t=p),c.lastIndex=p.index+p[1].length+p[2].length;c.lastIndex=-1}if(t===null)return null;const n=t[2],s=t[3]||"0",o=t[4]||"0",i=e.includePrerelease&&t[5]?`-${t[5]}`:"",l=e.includePrerelease&&t[6]?`+${t[6]}`:"";return Sn(`${n}.${s}.${o}${i}${l}`,e)};var An=wn;class _n{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){const s=this.map.keys().next().value;this.delete(s)}this.map.set(e,t)}return this}}var xn=_n,de,He;function D(){if(He)return de;He=1;const r=/\s+/g;class e{constructor(u,v){if(v=s(v),u instanceof e)return u.loose===!!v.loose&&u.includePrerelease===!!v.includePrerelease?u:new e(u.raw,v);if(u instanceof o)return this.raw=u.value,this.set=[[u]],this.formatted=void 0,this;if(this.options=v,this.loose=!!v.loose,this.includePrerelease=!!v.includePrerelease,this.raw=u.trim().replace(r," "),this.set=this.raw.split("||").map(E=>this.parseRange(E.trim())).filter(E=>E.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const E=this.set[0];if(this.set=this.set.filter(I=>!$(I[0])),this.set.length===0)this.set=[E];else if(this.set.length>1){for(const I of this.set)if(I.length===1&&U(I[0])){this.set=[I];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let u=0;u<this.set.length;u++){u>0&&(this.formatted+="||");const v=this.set[u];for(let E=0;E<v.length;E++)E>0&&(this.formatted+=" "),this.formatted+=v[E].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(u){const E=((this.options.includePrerelease&&m)|(this.options.loose&&K))+":"+u,I=n.get(E);if(I)return I;const d=this.options.loose,L=d?c[p.HYPHENRANGELOOSE]:c[p.HYPHENRANGE];u=u.replace(L,Mt(this.options.includePrerelease)),i("hyphen replace",u),u=u.replace(c[p.COMPARATORTRIM],a),i("comparator trim",u),u=u.replace(c[p.TILDETRIM],h),i("tilde trim",u),u=u.replace(c[p.CARETTRIM],N),i("caret trim",u);let O=u.split(" ").map(A=>V(A,this.options)).join(" ").split(/\s+/).map(A=>Ft(A,this.options));d&&(O=O.filter(A=>(i("loose invalid filter",A,this.options),!!A.match(c[p.COMPARATORLOOSE])))),i("range list",O);const R=new Map,S=O.map(A=>new o(A,this.options));for(const A of S){if($(A))return[A];R.set(A.value,A)}R.size>1&&R.has("")&&R.delete("");const y=[...R.values()];return n.set(E,y),y}intersects(u,v){if(!(u instanceof e))throw new TypeError("a Range is required");return this.set.some(E=>C(E,v)&&u.set.some(I=>C(I,v)&&E.every(d=>I.every(L=>d.intersects(L,v)))))}test(u){if(!u)return!1;if(typeof u=="string")try{u=new l(u,this.options)}catch{return!1}for(let v=0;v<this.set.length;v++)if(Gt(this.set[v],u,this.options))return!0;return!1}}de=e;const t=xn,n=new t,s=Oe,o=ue(),i=ce,l=x,{safeRe:c,t:p,comparatorTrimReplace:a,tildeTrimReplace:h,caretTrimReplace:N}=J,{FLAG_INCLUDE_PRERELEASE:m,FLAG_LOOSE:K}=ae,$=f=>f.value==="<0.0.0-0",U=f=>f.value==="",C=(f,u)=>{let v=!0;const E=f.slice();let I=E.pop();for(;v&&E.length;)v=E.every(d=>I.intersects(d,u)),I=E.pop();return v},V=(f,u)=>(f=f.replace(c[p.BUILD],""),i("comp",f,u),f=Ct(f,u),i("caret",f),f=F(f,u),i("tildes",f),f=Dt(f,u),i("xrange",f),f=Ut(f,u),i("stars",f),f),_=f=>!f||f.toLowerCase()==="x"||f==="*",F=(f,u)=>f.trim().split(/\s+/).map(v=>yt(v,u)).join(" "),yt=(f,u)=>{const v=u.loose?c[p.TILDELOOSE]:c[p.TILDE];return f.replace(v,(E,I,d,L,O)=>{i("tilde",f,E,I,d,L,O);let R;return _(I)?R="":_(d)?R=`>=${I}.0.0 <${+I+1}.0.0-0`:_(L)?R=`>=${I}.${d}.0 <${I}.${+d+1}.0-0`:O?(i("replaceTilde pr",O),R=`>=${I}.${d}.${L}-${O} <${I}.${+d+1}.0-0`):R=`>=${I}.${d}.${L} <${I}.${+d+1}.0-0`,i("tilde return",R),R})},Ct=(f,u)=>f.trim().split(/\s+/).map(v=>Pt(v,u)).join(" "),Pt=(f,u)=>{i("caret",f,u);const v=u.loose?c[p.CARETLOOSE]:c[p.CARET],E=u.includePrerelease?"-0":"";return f.replace(v,(I,d,L,O,R)=>{i("caret",f,I,d,L,O,R);let S;return _(d)?S="":_(L)?S=`>=${d}.0.0${E} <${+d+1}.0.0-0`:_(O)?d==="0"?S=`>=${d}.${L}.0${E} <${d}.${+L+1}.0-0`:S=`>=${d}.${L}.0${E} <${+d+1}.0.0-0`:R?(i("replaceCaret pr",R),d==="0"?L==="0"?S=`>=${d}.${L}.${O}-${R} <${d}.${L}.${+O+1}-0`:S=`>=${d}.${L}.${O}-${R} <${d}.${+L+1}.0-0`:S=`>=${d}.${L}.${O}-${R} <${+d+1}.0.0-0`):(i("no pr"),d==="0"?L==="0"?S=`>=${d}.${L}.${O}${E} <${d}.${L}.${+O+1}-0`:S=`>=${d}.${L}.${O}${E} <${d}.${+L+1}.0-0`:S=`>=${d}.${L}.${O} <${+d+1}.0.0-0`),i("caret return",S),S})},Dt=(f,u)=>(i("replaceXRanges",f,u),f.split(/\s+/).map(v=>bt(v,u)).join(" ")),bt=(f,u)=>{f=f.trim();const v=u.loose?c[p.XRANGELOOSE]:c[p.XRANGE];return f.replace(v,(E,I,d,L,O,R)=>{i("xRange",f,E,I,d,L,O,R);const S=_(d),y=S||_(L),A=y||_(O),Y=A;return I==="="&&Y&&(I=""),R=u.includePrerelease?"-0":"",S?I===">"||I==="<"?E="<0.0.0-0":E="*":I&&Y?(y&&(L=0),O=0,I===">"?(I=">=",y?(d=+d+1,L=0,O=0):(L=+L+1,O=0)):I==="<="&&(I="<",y?d=+d+1:L=+L+1),I==="<"&&(R="-0"),E=`${I+d}.${L}.${O}${R}`):y?E=`>=${d}.0.0${R} <${+d+1}.0.0-0`:A&&(E=`>=${d}.${L}.0${R} <${d}.${+L+1}.0-0`),i("xRange return",E),E})},Ut=(f,u)=>(i("replaceStars",f,u),f.trim().replace(c[p.STAR],"")),Ft=(f,u)=>(i("replaceGTE0",f,u),f.trim().replace(c[u.includePrerelease?p.GTE0PRE:p.GTE0],"")),Mt=f=>(u,v,E,I,d,L,O,R,S,y,A,Y)=>(_(E)?v="":_(I)?v=`>=${E}.0.0${f?"-0":""}`:_(d)?v=`>=${E}.${I}.0${f?"-0":""}`:L?v=`>=${v}`:v=`>=${v}${f?"-0":""}`,_(S)?R="":_(y)?R=`<${+S+1}.0.0-0`:_(A)?R=`<${S}.${+y+1}.0-0`:Y?R=`<=${S}.${y}.${A}-${Y}`:f?R=`<${S}.${y}.${+A+1}-0`:R=`<=${R}`,`${v} ${R}`.trim()),Gt=(f,u,v)=>{for(let E=0;E<f.length;E++)if(!f[E].test(u))return!1;if(u.prerelease.length&&!v.includePrerelease){for(let E=0;E<f.length;E++)if(i(f[E].semver),f[E].semver!==o.ANY&&f[E].semver.prerelease.length>0){const I=f[E].semver;if(I.major===u.major&&I.minor===u.minor&&I.patch===u.patch)return!0}return!1}return!0};return de}var pe,ze;function ue(){if(ze)return pe;ze=1;const r=Symbol("SemVer ANY");class e{static get ANY(){return r}constructor(a,h){if(h=t(h),a instanceof e){if(a.loose===!!h.loose)return a;a=a.value}a=a.trim().split(/\s+/).join(" "),i("comparator",a,h),this.options=h,this.loose=!!h.loose,this.parse(a),this.semver===r?this.value="":this.value=this.operator+this.semver.version,i("comp",this)}parse(a){const h=this.options.loose?n[s.COMPARATORLOOSE]:n[s.COMPARATOR],N=a.match(h);if(!N)throw new TypeError(`Invalid comparator: ${a}`);this.operator=N[1]!==void 0?N[1]:"",this.operator==="="&&(this.operator=""),N[2]?this.semver=new l(N[2],this.options.loose):this.semver=r}toString(){return this.value}test(a){if(i("Comparator.test",a,this.options.loose),this.semver===r||a===r)return!0;if(typeof a=="string")try{a=new l(a,this.options)}catch{return!1}return o(a,this.operator,this.semver,this.options)}intersects(a,h){if(!(a instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new c(a.value,h).test(this.value):a.operator===""?a.value===""?!0:new c(this.value,h).test(a.semver):(h=t(h),h.includePrerelease&&(this.value==="<0.0.0-0"||a.value==="<0.0.0-0")||!h.includePrerelease&&(this.value.startsWith("<0.0.0")||a.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&a.operator.startsWith(">")||this.operator.startsWith("<")&&a.operator.startsWith("<")||this.semver.version===a.semver.version&&this.operator.includes("=")&&a.operator.includes("=")||o(this.semver,"<",a.semver,h)&&this.operator.startsWith(">")&&a.operator.startsWith("<")||o(this.semver,">",a.semver,h)&&this.operator.startsWith("<")&&a.operator.startsWith(">")))}}pe=e;const t=Oe,{safeRe:n,t:s}=J,o=wt,i=ce,l=x,c=D();return pe}const yn=D(),Cn=(r,e,t)=>{try{e=new yn(e,t)}catch{return!1}return e.test(r)};var fe=Cn;const Pn=D(),Dn=(r,e)=>new Pn(r,e).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));var bn=Dn;const Un=x,Fn=D(),Mn=(r,e,t)=>{let n=null,s=null,o=null;try{o=new Fn(e,t)}catch{return null}return r.forEach(i=>{o.test(i)&&(!n||s.compare(i)===-1)&&(n=i,s=new Un(n,t))}),n};var Gn=Mn;const jn=x,Vn=D(),Bn=(r,e,t)=>{let n=null,s=null,o=null;try{o=new Vn(e,t)}catch{return null}return r.forEach(i=>{o.test(i)&&(!n||s.compare(i)===1)&&(n=i,s=new jn(n,t))}),n};var kn=Bn;const me=x,Xn=D(),qe=le,Hn=(r,e)=>{r=new Xn(r,e);let t=new me("0.0.0");if(r.test(t)||(t=new me("0.0.0-0"),r.test(t)))return t;t=null;for(let n=0;n<r.set.length;++n){const s=r.set[n];let o=null;s.forEach(i=>{const l=new me(i.semver.version);switch(i.operator){case">":l.prerelease.length===0?l.patch++:l.prerelease.push(0),l.raw=l.format();case"":case">=":(!o||qe(l,o))&&(o=l);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${i.operator}`)}}),o&&(!t||qe(t,o))&&(t=o)}return t&&r.test(t)?t:null};var zn=Hn;const qn=D(),Kn=(r,e)=>{try{return new qn(r,e).range||"*"}catch{return null}};var Yn=Kn;const Wn=x,At=ue(),{ANY:Zn}=At,Jn=D(),Qn=fe,Ke=le,Ye=Se,es=Ae,ts=we,rs=(r,e,t,n)=>{r=new Wn(r,n),e=new Jn(e,n);let s,o,i,l,c;switch(t){case">":s=Ke,o=es,i=Ye,l=">",c=">=";break;case"<":s=Ye,o=ts,i=Ke,l="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Qn(r,e,n))return!1;for(let p=0;p<e.set.length;++p){const a=e.set[p];let h=null,N=null;if(a.forEach(m=>{m.semver===Zn&&(m=new At(">=0.0.0")),h=h||m,N=N||m,s(m.semver,h.semver,n)?h=m:i(m.semver,N.semver,n)&&(N=m)}),h.operator===l||h.operator===c||(!N.operator||N.operator===l)&&o(r,N.semver))return!1;if(N.operator===c&&i(r,N.semver))return!1}return!0};var _e=rs;const ns=_e,ss=(r,e,t)=>ns(r,e,">",t);var is=ss;const os=_e,as=(r,e,t)=>os(r,e,"<",t);var cs=as;const We=D(),ls=(r,e,t)=>(r=new We(r,t),e=new We(e,t),r.intersects(e,t));var us=ls;const fs=fe,hs=P;var Es=(r,e,t)=>{const n=[];let s=null,o=null;const i=r.sort((a,h)=>hs(a,h,t));for(const a of i)fs(a,e,t)?(o=a,s||(s=a)):(o&&n.push([s,o]),o=null,s=null);s&&n.push([s,null]);const l=[];for(const[a,h]of n)a===h?l.push(a):!h&&a===i[0]?l.push("*"):h?a===i[0]?l.push(`<=${h}`):l.push(`${a} - ${h}`):l.push(`>=${a}`);const c=l.join(" || "),p=typeof e.raw=="string"?e.raw:String(e);return c.length<p.length?c:e};const Ze=D(),xe=ue(),{ANY:ve}=xe,W=fe,ye=P,ds=(r,e,t={})=>{if(r===e)return!0;r=new Ze(r,t),e=new Ze(e,t);let n=!1;e:for(const s of r.set){for(const o of e.set){const i=ms(s,o,t);if(n=n||i!==null,i)continue e}if(n)return!1}return!0},ps=[new xe(">=0.0.0-0")],Je=[new xe(">=0.0.0")],ms=(r,e,t)=>{if(r===e)return!0;if(r.length===1&&r[0].semver===ve){if(e.length===1&&e[0].semver===ve)return!0;t.includePrerelease?r=ps:r=Je}if(e.length===1&&e[0].semver===ve){if(t.includePrerelease)return!0;e=Je}const n=new Set;let s,o;for(const m of r)m.operator===">"||m.operator===">="?s=Qe(s,m,t):m.operator==="<"||m.operator==="<="?o=et(o,m,t):n.add(m.semver);if(n.size>1)return null;let i;if(s&&o){if(i=ye(s.semver,o.semver,t),i>0)return null;if(i===0&&(s.operator!==">="||o.operator!=="<="))return null}for(const m of n){if(s&&!W(m,String(s),t)||o&&!W(m,String(o),t))return null;for(const K of e)if(!W(m,String(K),t))return!1;return!0}let l,c,p,a,h=o&&!t.includePrerelease&&o.semver.prerelease.length?o.semver:!1,N=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1;h&&h.prerelease.length===1&&o.operator==="<"&&h.prerelease[0]===0&&(h=!1);for(const m of e){if(a=a||m.operator===">"||m.operator===">=",p=p||m.operator==="<"||m.operator==="<=",s){if(N&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===N.major&&m.semver.minor===N.minor&&m.semver.patch===N.patch&&(N=!1),m.operator===">"||m.operator===">="){if(l=Qe(s,m,t),l===m&&l!==s)return!1}else if(s.operator===">="&&!W(s.semver,String(m),t))return!1}if(o){if(h&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===h.major&&m.semver.minor===h.minor&&m.semver.patch===h.patch&&(h=!1),m.operator==="<"||m.operator==="<="){if(c=et(o,m,t),c===m&&c!==o)return!1}else if(o.operator==="<="&&!W(o.semver,String(m),t))return!1}if(!m.operator&&(o||s)&&i!==0)return!1}return!(s&&p&&!o&&i!==0||o&&a&&!s&&i!==0||N||h)},Qe=(r,e,t)=>{if(!r)return e;const n=ye(r.semver,e.semver,t);return n>0?r:n<0||e.operator===">"&&r.operator===">="?e:r},et=(r,e,t)=>{if(!r)return e;const n=ye(r.semver,e.semver,t);return n<0?r:n>0||e.operator==="<"&&r.operator==="<="?e:r};var vs=ds;const Ie=J,tt=ae,Is=x,rt=Ot,$s=q,Ls=Tr,Rs=Ar,gs=xr,Ns=Cr,Os=br,Ts=Mr,Ss=Vr,ws=Xr,As=P,_s=Kr,xs=Zr,ys=Te,Cs=tn,Ps=sn,Ds=le,bs=Se,Us=Tt,Fs=St,Ms=we,Gs=Ae,js=wt,Vs=An,Bs=ue(),ks=D(),Xs=fe,Hs=bn,zs=Gn,qs=kn,Ks=zn,Ys=Yn,Ws=_e,Zs=is,Js=cs,Qs=us,ei=Es,ti=vs;var ri={parse:$s,valid:Ls,clean:Rs,inc:gs,diff:Ns,major:Os,minor:Ts,patch:Ss,prerelease:ws,compare:As,rcompare:_s,compareLoose:xs,compareBuild:ys,sort:Cs,rsort:Ps,gt:Ds,lt:bs,eq:Us,neq:Fs,gte:Ms,lte:Gs,cmp:js,coerce:Vs,Comparator:Bs,Range:ks,satisfies:Xs,toComparators:Hs,maxSatisfying:zs,minSatisfying:qs,minVersion:Ks,validRange:Ys,outside:Ws,gtr:Zs,ltr:Js,intersects:Qs,simplifyRange:ei,subset:ti,SemVer:Is,re:Ie.re,src:Ie.src,tokens:Ie.t,SEMVER_SPEC_VERSION:tt.SEMVER_SPEC_VERSION,RELEASE_TYPES:tt.RELEASE_TYPES,compareIdentifiers:rt.compareIdentifiers,rcompareIdentifiers:rt.rcompareIdentifiers};const nt=ut(ri);var w;(function(r){r.blue="blue",r.nanoS="nanoS",r.nanoSP="nanoSP",r.nanoX="nanoX",r.stax="stax",r.europa="europa",r.apex="apex"})(w||(w={}));const Le={[w.blue]:{id:w.blue,productName:"Ledger Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:480*1024,masks:[822083584,822149120],getBlockSize:r=>4*1024},[w.nanoS]:{id:w.nanoS,productName:"Ledger Nano S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:320*1024,masks:[823132160],getBlockSize:r=>nt.lt(nt.coerce(r)??"","2.0.0")?4*1024:2*1024},[w.nanoX]:{id:w.nanoX,productName:"Ledger Nano X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2*1024*1024,masks:[855638016],getBlockSize:r=>4*1024,bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},[w.nanoSP]:{id:w.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1533*1024,masks:[856686592],getBlockSize:r=>32},[w.apex]:{id:w.apex,productName:"Ledger Nano Gen5",productIdMM:128,legacyUsbProductId:8,usbOnly:!1,memorySize:1533*1024,masks:[859832320],getBlockSize:r=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-8004-0000-4c6564676572",notifyUuid:"13d63400-2c97-8004-0001-4c6564676572",writeUuid:"13d63400-2c97-8004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-8004-0003-4c6564676572"}]},[w.stax]:{id:w.stax,productName:"Ledger Stax",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:1533*1024,masks:[857735168],getBlockSize:r=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]},[w.europa]:{id:w.europa,productName:"Ledger Flex",productIdMM:112,legacyUsbProductId:7,usbOnly:!1,memorySize:1533*1024,masks:[858783744],getBlockSize:r=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-3004-0000-4c6564676572",notifyUuid:"13d63400-2c97-3004-0001-4c6564676572",writeUuid:"13d63400-2c97-3004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-3004-0003-4c6564676572"}]}};w.blue,w.nanoS,w.nanoSP,w.nanoX,w.stax,w.europa;const st=Object.values(Le),_t=11415,it=r=>{const e=st.find(s=>s.legacyUsbProductId===r);if(e)return e;const t=r>>8;return st.find(s=>s.productIdMM===t)},ni=[],ot={};for(const r in Le){const e=Le[r],{bluetoothSpec:t}=e;if(t)for(let n=0;n<t.length;n++){const s=t[n];ni.push(s.serviceUuid),ot[s.serviceUuid]=ot[s.serviceUuid.replace(/-/g,"")]={deviceModel:e,...s}}}const si=[{vendorId:_t}];async function xt(){return await navigator.usb.requestDevice({filters:si})}async function Re(){return(await navigator.usb.getDevices()).filter(e=>e.vendorId===_t)}async function ii(){const r=await Re();return r.length>0?r[0]:xt()}const oi=()=>Promise.resolve(!!navigator&&!!navigator.usb&&typeof navigator.usb.getDevices=="function"),ai=1,at=3,G=class G extends B{constructor(t,n){super();g(this,"device");g(this,"deviceModel");g(this,"channel",Math.floor(Math.random()*65535));g(this,"packetSize",64);g(this,"interfaceNumber");g(this,"_disconnectEmitted",!1);g(this,"_emitDisconnect",t=>{this._disconnectEmitted||(this._disconnectEmitted=!0,this.emit("disconnect",t))});this.device=t,this.interfaceNumber=n,this.deviceModel=it(t.productId)}static async request(){const t=await xt();return G.open(t)}static async openConnected(){const t=await Re();return t.length===0?null:G.open(t[0])}static async open(t){await t.open(),t.configuration===null&&await t.selectConfiguration(ai),await lt(t);const n=t.configurations[0].interfaces.find(({alternates:l})=>l.some(c=>c.interfaceClass===255));if(!n)throw new De("No WebUSB interface found for your Ledger device. Please upgrade firmware or contact techsupport.");const s=n.interfaceNumber;try{await t.claimInterface(s)}catch(l){throw await t.close(),new De(l.message)}const o=new G(t,s),i=l=>{t===l.device&&(navigator.usb.removeEventListener("disconnect",i),o._emitDisconnect(new Jt))};return navigator.usb.addEventListener("disconnect",i),o}async close(){await this.exchangeBusyPromise,await this.device.releaseInterface(this.interfaceNumber),await lt(this.device),await this.device.close()}async exchange(t){return await this.exchangeAtomicImpl(async()=>{const{channel:s,packetSize:o}=this;Ue("apdu","=> "+t.toString("hex"));const i=lr(s,o),l=i.makeBlocks(t);for(let a=0;a<l.length;a++)await this.device.transferOut(at,l[a]);let c,p;for(;!(c=i.getReducedResult(p));){const a=await this.device.transferIn(at,o),h=Buffer.from(a.data.buffer);p=i.reduceResponse(p,h)}return Ue("apdu","<= "+c.toString("hex")),c}).catch(s=>{throw s&&s.message&&s.message.includes("disconnected")?(this._emitDisconnect(s),new Qt(s.message)):s})}setScrambleKey(){}};g(G,"isSupported",oi),g(G,"list",Re),g(G,"listen",t=>{let n=!1;ii().then(o=>{if(!n){const i=it(o.productId);t.next({type:"add",descriptor:o,deviceModel:i}),t.complete()}},o=>{window.DOMException&&o instanceof window.DOMException&&o.code===18?t.error(new rr(o.message)):t.error(new er(o.message))});function s(){n=!0}return{unsubscribe:s}});let ct=G;async function lt(r){try{await r.reset()}catch(e){console.warn(e)}}export{ct as default};
